{"ast":null,"code":"import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { environment } from '../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nvar ApiService = /** @class */function () {\n  function ApiService(httpClient) {\n    this.httpClient = httpClient;\n    this.THREE_YEARS = 365 * 3;\n    this.FOUR_WEEKS = 28;\n    this.getToken();\n    this.headerParams = new HttpHeaders();\n    this.headerParams = this.headerParams.set('Authorization', \"Bearer \".concat(this.oauthToken));\n    this.headerParams = this.headerParams.set('Content-Type', 'application/json');\n  }\n  ApiService.prototype.getToken = function () {\n    var hash = window.location.hash.slice(1, window.location.hash.length - 1);\n    var hashParams = new URLSearchParams(hash);\n    if (hashParams.has('access_token')) {\n      this.oauthToken = hashParams.get('access_token');\n    }\n  };\n  ApiService.prototype.logIn = function () {\n    window.location.href = \"\".concat(environment.wcaUrl, \"/oauth/authorize?client_id=\").concat(environment.wcaAppId) + \"&redirect_uri=\".concat(environment.appUrl, \"&response_type=token&scope=manage_competitions\");\n  };\n  ApiService.prototype.getCompetitions = function () {\n    var url = \"\".concat(environment.wcaUrl, \"/api/v0/competitions?managed_by_me=true\");\n    var startDate = new Date();\n    startDate.setDate(startDate.getDate() - (environment.testMode ? this.THREE_YEARS : this.FOUR_WEEKS));\n    url += \"&start=\".concat(startDate.toISOString());\n    return this.httpClient.get(url, {\n      headers: this.headerParams\n    });\n  };\n  ApiService.prototype.getWcif = function (competitionId) {\n    if (environment.testMode) {\n      return this.httpClient.get(\"https://www.worldcubeassociation.org/api/v0/competitions/AnnuntiaOpen2020/wcif/public\", {\n        headers: this.headerParams\n      });\n    }\n    return this.httpClient.get(\"\".concat(environment.wcaUrl, \"/api/v0/competitions/\").concat(competitionId, \"/wcif\"), {\n      headers: this.headerParams\n    });\n  };\n  ApiService.ɵfac = function ApiService_Factory(t) {\n    return new (t || ApiService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  ApiService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ApiService,\n    factory: ApiService.ɵfac,\n    providedIn: 'root'\n  });\n  return ApiService;\n}();\nexport { ApiService };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}