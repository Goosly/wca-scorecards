{"ast":null,"code":"import { ApiService } from '../common/api';\nimport { ScoreCardService } from '../common/scorecard';\nimport { getEventName } from '@wca/helpers';\nimport { GeneralConfiguration } from '../common/classes';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../common/api\";\nimport * as i2 from \"../common/scorecard\";\nfunction AppComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_5_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.handleLoginToWca());\n    });\n    i0.ɵɵtext(2, \"First: login\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_6_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Select a competition:\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_6_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"p\")(1, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_6_p_4_Template_button_click_1_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r11);\n      var competitionId_r9 = restoredCtx.$implicit;\n      var ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.handleCompetitionSelected(competitionId_r9));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    var competitionId_r9 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(competitionId_r9);\n  }\n}\nfunction AppComponent_div_6_p_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"You don't have any competition available :-(\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"Welcome!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, AppComponent_div_6_p_3_Template, 2, 0, \"p\", 3);\n    i0.ɵɵtemplate(4, AppComponent_div_6_p_4_Template, 3, 1, \"p\", 10);\n    i0.ɵɵtemplate(5, AppComponent_div_6_p_5_Template, 2, 0, \"p\", 3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.competitionsToChooseFrom);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.competitionsToChooseFrom);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !!ctx_r1.competitionsToChooseFrom && ctx_r1.competitionsToChooseFrom.length === 0);\n  }\n}\nfunction AppComponent_div_7_tr_25_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_tr_25_button_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      var event_r13 = i0.ɵɵnextContext().$implicit;\n      var ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.scoreCardService.printScoreCardsForRound(ctx_r17.wcif, event_r13, 1, ctx_r17.config));\n    });\n    i0.ɵɵelement(1, \"i\", 18);\n    i0.ɵɵtext(2, \" Round 2\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var event_r13 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"disabled\", (event_r13.rounds[1] == null ? null : event_r13.rounds[1].results == null ? null : event_r13.rounds[1].results.length) === 0);\n  }\n}\nfunction AppComponent_div_7_tr_25_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_tr_25_button_10_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r22);\n      var event_r13 = i0.ɵɵnextContext().$implicit;\n      var ctx_r21 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r21.scoreCardService.printScoreCardsForRound(ctx_r21.wcif, event_r13, 2, ctx_r21.config));\n    });\n    i0.ɵɵelement(1, \"i\", 18);\n    i0.ɵɵtext(2, \" Round 3\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var event_r13 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"disabled\", (event_r13.rounds[2] == null ? null : event_r13.rounds[2].results == null ? null : event_r13.rounds[2].results.length) === 0);\n  }\n}\nfunction AppComponent_div_7_tr_25_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_tr_25_button_12_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r26);\n      var event_r13 = i0.ɵɵnextContext().$implicit;\n      var ctx_r25 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r25.scoreCardService.printScoreCardsForRound(ctx_r25.wcif, event_r13, 3, ctx_r25.config));\n    });\n    i0.ɵɵelement(1, \"i\", 18);\n    i0.ɵɵtext(2, \" Round 4\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var event_r13 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"disabled\", (event_r13.rounds[3] == null ? null : event_r13.rounds[3].results == null ? null : event_r13.rounds[3].results.length) === 0);\n  }\n}\nfunction AppComponent_div_7_tr_25_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r30 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_tr_25_Template_button_click_4_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r30);\n      var event_r13 = restoredCtx.$implicit;\n      var ctx_r29 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r29.scoreCardService.printScoreCardsForRound(ctx_r29.wcif, event_r13, 0, ctx_r29.config));\n    });\n    i0.ɵɵelement(5, \"i\", 18);\n    i0.ɵɵtext(6, \" Round 1\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtemplate(8, AppComponent_div_7_tr_25_button_8_Template, 3, 1, \"button\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtemplate(10, AppComponent_div_7_tr_25_button_10_Template, 3, 1, \"button\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtemplate(12, AppComponent_div_7_tr_25_button_12_Template, 3, 1, \"button\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    var event_r13 = ctx.$implicit;\n    var ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r12.nameOfEventId(event_r13.id));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", (event_r13.rounds[0] == null ? null : event_r13.rounds[0].results == null ? null : event_r13.rounds[0].results.length) === 0);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", event_r13.rounds.length >= 2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", event_r13.rounds.length >= 3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", event_r13.rounds.length >= 4);\n  }\n}\nfunction AppComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r32 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementStart(5, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r32);\n      var ctx_r31 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r31.handleRefreshCompetition());\n    });\n    i0.ɵɵelement(6, \"i\", 13);\n    i0.ɵɵtext(7, \" Refresh results\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"p\", 14);\n    i0.ɵɵtext(9, \"When you've finished entering the results of a round in WCA Live, open the next round and 'Synchronize' in WCA Live. Then click 'Refresh results' here and the scorecards for the round you just opened will be available.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"br\");\n    i0.ɵɵelementStart(11, \"p\", 14);\n    i0.ɵɵtext(12, \"First rounds are sorted alphabetically (note that you should rather be using a grouping tool for first rounds).\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\", 14);\n    i0.ɵɵtext(14, \"For other rounds, competitors are always sorted by their ranking in the previous round.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"br\");\n    i0.ɵɵelementStart(16, \"p\", 14);\n    i0.ɵɵtext(17, \"Split competitors into \");\n    i0.ɵɵelementStart(18, \"input\", 15);\n    i0.ɵɵlistener(\"ngModelChange\", function AppComponent_div_7_Template_input_ngModelChange_18_listener($event) {\n      i0.ɵɵrestoreView(_r32);\n      var ctx_r33 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r33.config.numberOfGroups = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \" groups\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"p\", 14)(21, \"input\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function AppComponent_div_7_Template_input_ngModelChange_21_listener($event) {\n      i0.ɵɵrestoreView(_r32);\n      var ctx_r34 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r34.config.printStationNumbers = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(22, \" Print station numbers for fixed seating\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(23, \"br\");\n    i0.ɵɵelementStart(24, \"table\", 17);\n    i0.ɵɵtemplate(25, AppComponent_div_7_tr_25_Template, 13, 5, \"tr\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(26, \"br\");\n    i0.ɵɵelementStart(27, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_Template_button_click_27_listener() {\n      i0.ɵɵrestoreView(_r32);\n      var ctx_r35 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r35.scoreCardService.printFourEmptyScorecards(ctx_r35.wcif));\n    });\n    i0.ɵɵelement(28, \"i\", 18);\n    i0.ɵɵtext(29, \" Empty scorecards\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Selected competition: \", ctx_r2.competitionId, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.wcif.events == null ? null : ctx_r2.wcif.events.length, \" events found...\\u00A0\\u00A0\");\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.config.numberOfGroups);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.config.printStationNumbers);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.wcif.events);\n  }\n}\nfunction AppComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"Refreshing...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nvar AppComponent = /** @class */function () {\n  function AppComponent(apiService, scoreCardService) {\n    this.apiService = apiService;\n    this.scoreCardService = scoreCardService;\n    this.state = 'PRINT';\n    this.competitionsToChooseFrom = null;\n    this.config = new GeneralConfiguration();\n    if (this.apiService.oauthToken) {\n      this.handleGetCompetitions();\n    }\n  }\n  AppComponent.prototype.handleLoginToWca = function () {\n    this.apiService.logIn();\n  };\n  AppComponent.prototype.handleGetCompetitions = function () {\n    var _this = this;\n    this.apiService.getCompetitions().subscribe(function (comps) {\n      if (comps.length === 1) {\n        _this.handleCompetitionSelected(comps[0]['id']);\n      }\n      _this.competitionsToChooseFrom = comps.map(function (c) {\n        return c['id'];\n      });\n    });\n  };\n  AppComponent.prototype.handleCompetitionSelected = function (competitionId) {\n    this.competitionId = competitionId;\n    this.loadWcif();\n  };\n  AppComponent.prototype.handleRefreshCompetition = function () {\n    this.state = 'REFRESHING';\n    this.loadWcif();\n  };\n  AppComponent.prototype.handlePrintAllFirstRounds = function () {\n    // todo\n  };\n  AppComponent.prototype.nameOfEventId = function (id) {\n    return getEventName(id);\n  };\n  AppComponent.prototype.loadWcif = function () {\n    var _this = this;\n    this.apiService.getWcif(this.competitionId).subscribe(function (wcif) {\n      _this.wcif = wcif;\n      try {\n        _this.wcif.events = _this.wcif.events.filter(function (e) {\n          return e.id !== '333fm';\n        });\n        _this.wcif.persons.forEach(function (p) {\n          p.fullName = p.name;\n          p.name = p.name.split('(')[0];\n        });\n        _this.state = 'PRINT';\n      } catch (error) {\n        alert('An error occured, see console');\n        console.error(error);\n        _this.wcif = null;\n        _this.competitionId = null;\n      }\n    });\n  };\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.ScoreCardService));\n  };\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"my-app\"]],\n    decls: 17,\n    vars: 4,\n    consts: [[1, \"wrapper\"], [1, \"header\", \"center\"], [1, \"content\", \"center\"], [4, \"ngIf\"], [1, \"footer\", \"left\"], [\"href\", \"https://github.com/Goosly/wca-scorecards/wiki\", \"target\", \"_blank\"], [1, \"fa\", \"fa-book\"], [\"href\", \"https://github.com/Goosly/wca-scorecards\", \"target\", \"_blank\"], [1, \"fa\", \"fa-github\"], [1, \"login\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [1, \"competition\", 3, \"click\"], [3, \"click\"], [1, \"fa\", \"fa-refresh\"], [1, \"info-center\"], [\"type\", \"number\", \"min\", \"1\", \"step\", \"1\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"checkbox\", \"min\", \"1\", \"step\", \"1\", 3, \"ngModel\", \"ngModelChange\"], [1, \"center\"], [1, \"fa\", \"fa-download\"], [3, \"disabled\", \"click\"], [3, \"disabled\", \"click\", 4, \"ngIf\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\");\n        i0.ɵɵtext(3, \"WCA Competition Scorecards\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"div\", 2);\n        i0.ɵɵtemplate(5, AppComponent_div_5_Template, 4, 0, \"div\", 3);\n        i0.ɵɵtemplate(6, AppComponent_div_6_Template, 6, 3, \"div\", 3);\n        i0.ɵɵtemplate(7, AppComponent_div_7_Template, 30, 5, \"div\", 3);\n        i0.ɵɵtemplate(8, AppComponent_div_8_Template, 3, 0, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 4)(10, \"a\", 5);\n        i0.ɵɵelement(11, \"i\", 6);\n        i0.ɵɵtext(12, \" Wiki\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(13, \"\\u00A0 \");\n        i0.ɵɵelementStart(14, \"a\", 7);\n        i0.ɵɵelement(15, \"i\", 8);\n        i0.ɵɵtext(16, \" Github\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.apiService.oauthToken);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.apiService.oauthToken && !ctx.competitionId);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.competitionId && ctx.wcif && ctx.state === \"PRINT\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.state === \"REFRESHING\");\n      }\n    },\n    styles: [\"div[_ngcontent-%COMP%]{font-family:Roboto,sans-serif}h1[_ngcontent-%COMP%]{margin:5;border-bottom:1px solid gray}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0}.wrapper[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.header[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]{width:100%}.content[_ngcontent-%COMP%]{width:100%;flex:1;overflow:auto}.center[_ngcontent-%COMP%]{text-align:center;margin:auto}.left[_ngcontent-%COMP%]{text-align:left;margin:auto}.login[_ngcontent-%COMP%]{font-size:25px}.competition[_ngcontent-%COMP%]{font-size:12px}button[_ngcontent-%COMP%]{background-color:#4ddbff;border:none;color:#fff;padding:6px 10px;text-align:center;text-decoration:none;display:inline-block}button[_ngcontent-%COMP%]:disabled{background-color:#767d87}textarea[_ngcontent-%COMP%]{width:500px;height:400px}.info-center[_ngcontent-%COMP%]{max-width:850px;text-align:center;margin:auto}input[type=number][_ngcontent-%COMP%]{width:40px}\"]\n  });\n  return AppComponent;\n}();\nexport { AppComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}